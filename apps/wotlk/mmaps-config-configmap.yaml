apiVersion: v1
kind: ConfigMap
metadata:
  name: wotlk-mmaps-config
  namespace: wotlk
data:
  mmaps-config.yaml: |
    mmapsConfig:
      skipLiquid: false
      skipContinents: false
      skipJunkMaps: true
      skipBattlegrounds: false

      # Path to the directory containing navigation data files.
      # This directory should contain the "maps" and "vmaps" folders,
      # and is also where the "mmaps" folder will be created or located.
      dataDir: "./"

      meshSettings:
        # Here we have global config for recast navigation.
        # It's possible to override these data on map or tile level (see mapsOverrides).

        # Maximum slope angle (in degrees) NPCs can walk on.
        # Surfaces steeper than this will be considered unwalkable.
        walkableSlopeAngle: 60

        # --- Cell Size Calculation ---
        # Many parameters below are defined in "cell units".
        # In RecastDemo, you often work with world units instead of cell units.
        # By default, these cell units are converted to world units using the formula:
        #
        #     cellSize = MMAP::GRID_SIZE / (verticesPerMapEdge - 1)
        #
        # Where:
        #     MMAP::GRID_SIZE = 533.3333f (the size of one map tile in world units)
        #     verticesPerMapEdge = number of vertices along one edge of the full map grid
        #
        # Example:
        #     If verticesPerMapEdge = 2000, then:
        #         cellSize ≈ 533.3333 / (2000 - 1) ≈ 0.2667 world units per cell
        #
        # To convert a value from cell units to world units (e.g., walkableClimb),
        # multiply by cellSize. For example, a walkableClimb of 6 corresponds to:
        #     6 * 0.2667 ≈ 1.6 world units

        # Minimum ceiling height (in cell units) NPCs need to pass under an obstacle.
        # Controls how much vertical clearance is required.
        # To convert to world units, multiply by cellSize (see "Cell Size Calculation").
        walkableHeight: 6

        # Maximum height difference (in cell units) NPCs can step up or down.
        # Higher values allow walking over fences, ledges, or steps.
        # To convert to world units, multiply by cellSize (see "Cell Size Calculation").
        #
        # Vanilla WotLK uses 6, which allows creatures to "jump" over fences.
        # Classic WotLK uses 4, which forces creatures to walk around fences.
        walkableClimb: 6

        # Minimum distance (in cell units) around walkable surfaces.
        # Helps prevent NPCs from clipping into walls and narrow gaps.
        # To convert to world units, multiply by cellSize (see "Cell Size Calculation").
        walkableRadius: 2

        # Number of vertices along one edge of the entire map's navmesh grid.
        # Higher values increase mesh resolution but also CPU/memory usage.
        verticesPerMapEdge: 2000

        # Number of vertices along one edge of each tile chunk.
        # Must divide (vertexPerMapEdge - 1) evenly for seamless tiles.
        # A higher vertex count per tile means fewer total tiles,
        # reducing runtime work to load, unload, and manage tiles.
        verticesPerTileEdge: 80

        # Tolerance for how much a polygon can deviate from the original geometry when simplified.
        # Higher values produce simpler (faster) meshes but can reduce accuracy.
        maxSimplificationError: 1.8

        # You can override any global parameter for a specific map by specifying its map ID.
        # Inside each map override, you can also override parameters per individual tile,
        # identified by a string "tileX,tileY" (coordinates).
        #
        # Overrides cascade: global settings → map overrides → tile overrides.
        mapsOverrides:
          "562": # Blade's Edge Arena
            walkableRadius: 0 # This allows walking on the ropes to the pillars

          "48": # Blackfathom Deeps
            cellSizeVertical: 0.5334 # ch*2 = 0.2667 * 2 ≈ 0.5334. Reduce the chance to have underground levels.

          "529": # Arathi Basin
            tilesOverrides:
              "30,29": # Lumber Mill
                # Make sure that Fear will not drop players from cliff -
                # https://github.com/azerothcore/azerothcore-wotlk/pull/22462#issuecomment-3067024680
                walkableSlopeAngle: 45

          "530": # Outland
            tilesOverrides:
              "32,30": # Dark portal
                walkableSlopeAngle: 45 # https://github.com/chromiecraft/chromiecraft/issues/8404#issuecomment-3476012660

      # debugOutput generates debug files in the `meshes` directory for use with RecastDemo.
      debugOutput: false

